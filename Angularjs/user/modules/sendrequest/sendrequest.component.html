<section class="content-header">
    <h1>
        Send Request
    </h1>
    <ol class="breadcrumb">
        <li class="active">Appointment</li>
    </ol>
</section>

<section class="content">
    <div class="row">
        <!-- /.col -->
        <div class="col-md-12">
            <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                    <li [ngClass]="{'active': !isActive }"><a href="#activity" data-toggle="tab">Details</a></li>
                    <li [ngClass]="{'active': isListActive }"><a href="#timeline" data-toggle="tab">Select Mechanics</a></li>
                </ul>
                <div class="tab-content">
                    <div class="active tab-pane" id="activity">
                        <div class="box box-solid">
                            <div class="box-header with-border">
                                <h3 class="box-title">Schedule an appointment to <b>{{userName}}</b></h3>
                            </div>
                            <!-- /.box-header -->
                            <div class="box-group" id="accordion">
                                <!-- we are adding the .panel class so bootstrap.js collapse plugin detects it -->
                                <div class="panel box box-primary">
                                    <div class="box-header with-border boxhead">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                                Repair Detail
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseOne" class="panel-collapse collapse in">
                                        <div class="box-body">
                                            <form id="RequestForm" [formGroup]="repairForm" novalidate>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Common Issues</label>
                                                            <div class="multiSelect">

                                                                <p-multiSelect maxSelectedLabels=0 [options]="commonIssue"
                                                                    formControlName="common" class="form-control"
                                                                    defaultLabel='Select' [(ngModel)]="selectedIssues">

                                                                </p-multiSelect>
                                                                <!-- <select formControlName="common" name="" id="" class="form-control">
                                                                        <option value="">Select</option>
                                                                        <option *ngFor='let issues of commonIssue' [value]="issues._id">{{issues.name}}</option>
                                                                    </select> -->
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Symptoms</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="symptom" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of symptoms' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">AC</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="ac" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of ACissue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Engine</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="engine" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of engineIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Fluid</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="fluid" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of fluidIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Exhaust</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="exhaust" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of exhaustIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Electrical</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="electric" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of electeicIssue'
                                                                        [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Gear</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="gear" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of gearIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Transmission</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="trans" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of transIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Brakes</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="brake" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of brakeIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Tires</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="tyre" name="" id="" class="form-control">
                                                                    <option value="">Select</option>
                                                                    <option *ngFor='let issues of tyreIssue' [value]="issues._id">{{issues.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right margin-top-20">
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-danger">
                                    <div class="box-header with-border boxhead">
                                        <h4 class="box-title">
                                            <!-- <a data-toggle="collapse" [style.pointer-events]="!isDisabled ?'none':'auto'" data-parent="#accordion" href="#collapseTwo"> -->
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                                                Car Detail
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseTwo" class="panel-collapse collapse">
                                        <div class="box-body">
                                            <ul class="cars_button">
                                                <li *ngFor="let car of carList; let i=index"><button class="btn btn-primary btn_custom_car"
                                                        (click)="getCar(car._id, car)">{{car.makeId}} {{car.modelId}}</button></li>
                                            </ul>
                                            <form id="RequestForm" [formGroup]="carForm" novalidate>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Year</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="year" #years class="form-control"
                                                                    (change)="ListMake(years.value)" required>
                                                                    <option [ngValue]="null" disabled [selected]="true">Select
                                                                        Year</option>
                                                                    <option *ngFor='let year of yearList' [value]='year.year'>{{year.year}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Make</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="make" #makes [(ngModel)]="defaultMake"
                                                                    (change)="ListModel(makes.value)" class="form-control"
                                                                    required>
                                                                    <option [ngValue]="null" disabled [selected]="true">Select
                                                                        Make</option>
                                                                    <option *ngFor='let make of makeList' [value]='make.make'>{{make.make
                                                                        | titlecase}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Model</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="model" #models [(ngModel)]="defaultModel"
                                                                    (change)="ListTrim(models.value)" class="form-control"
                                                                    required>
                                                                    <option [ngValue]="null" disabled [selected]="true">Select
                                                                        Model</option>
                                                                    <option *ngFor='let model of modelList' [value]='model.model'>{{model.model}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <label for="usr">Trim</label>
                                                            <div class="cardcaret">
                                                                <select formControlName="trim" [(ngModel)]="defaultTrim"
                                                                    class="form-control">
                                                                    <option [ngValue]="null" disabled [selected]="true">Select
                                                                        Trim</option>
                                                                    <option *ngFor='let trim of trimList' [value]='trim.trim'>{{trim.trim}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="form-group">
                                                            <label for="usr">Mileage</label>
                                                            <input min="0" [(ngModel)]="mileage" formControlName="mileage"
                                                                type="number" onkeydown="javascript: return event.keyCode == 69 ? false : true"
                                                                onKeyPress="if(this.value.length==6) return false;"
                                                                class="form-control" placeholder="Enter Mileage"
                                                                required>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right margin-top-20">
                                                    <!-- <button [disabled]="carForm.invalid" data-toggle="tab" href="#collapseThree" (click)="changeCarIsActive()" type="submit" class="btn btn-primary">
                                                            <span class="step-txt">next</span>
                                                        </button> -->
                                                    <!-- <button [disabled]="carForm.invalid"  type="submit" class="btn btn-primary">
                                                next
                                                </button> -->
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-success">
                                    <div class="box-header with-border boxhead">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                                                Appointment Detail
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseThree" class="panel-collapse collapse">
                                        <div class="box-body">
                                            <div class="card-form">
                                                <div class="row">
                                                    <div class="col-sm-12 col-md-4">
                                                        <div class="form-group">
                                                            <label for="usr">First Date Preference</label>
                                                            <p-calendar [minDate]='minDate' (onSelect)="onBlurMethod($event)"
                                                                [(ngModel)]="firstDate" class="form-control calendarBox"></p-calendar>
                                                            <i _ngcontent-c4="" aria-hidden="true" class="fa fa-calendar calendarIcon"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12 col-md-12">
                                                        <div class="form-group timeScrollableMain">
                                                            <!-- <div class="timeSelector {{i}}"  [style.background]="isClicked ? 'rgb(255, 215, 214)' : 'white'" (click)="firstDay($event, time.time)"  *ngFor="let time of timeList; let i=index;"><span class="left-align">{{time.time}}</span></div> -->
                                                            <div class="timeSelector" [class.background]="time.isSelected"
                                                                (click)="firstDay($event, time.time, time)" id="timeSelect{{i}}"
                                                                *ngFor="let time of timeList; let i=index;">
                                                                {{time?.time}}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row timeDisplay">
                                                    <div *ngFor="let dayt of firstDayTme"><span class="col-md-1">{{dayt}}</span></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12 col-md-4">
                                                        <div class="form-group">
                                                            <label for="usr">Second Date Preference</label>
                                                            <p-calendar [minDate]='minDate' (onSelect)="onBlurMethod2($event)"
                                                                [disabledDates]="invalidDates" [(ngModel)]="secondDate"
                                                                class="form-control calendarBox"></p-calendar>
                                                            <i _ngcontent-c4="" aria-hidden="true" class="fa fa-calendar calendarIcon"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12 col-md-12">
                                                        <div class="form-group timeScrollableMain">
                                                            <div class="timeSelector" [class.background]="time.isSelected"
                                                                (click)="secondDay($event, time.time, time)" *ngFor="let time of nexttimeList; let i=index;"><span
                                                                    class="left-align">{{time.time}}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row timeDisplay">
                                                    <div *ngFor="let dayt of secondDayTme"><span class="col-md-1">{{dayt}}</span></div>
                                                </div>
                                                <div class="text-right margin-top-20">
                                                    <button [disabled]="!firstDate || !secondDate" href="#timeline"
                                                        data-toggle="tab" type="submit" (click)="changeIsActive()"
                                                        class="btn btn-primary"><span class="step-txt">next</span></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.box-body -->
                        </div>
                        <!-- /.box -->

                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane" id="timeline">
                        <div class="form-group pull-right send_request_section col-md">
                            <form (ngSubmit)="getShopList(searchText)">
                                <div class="search-input search_input_details">
                                    <input [(ngModel)]="searchText" name="searchText" type="text" class="form-control"
                                        placeholder="EX: Zip/Shop Name" class="zip_details">
                                    <button id="search" style="width: 20px;" [disabled]="isDisabled" type="submit"
                                        class="btn btn-primary btn-sm">Search</button>
                                </div>
                            </form>

                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-sm-offset-0 col-md-10 col-md-offset-1">
                                <div *ngFor="let mech of mechanicList; let i=index">

                                    <div class="list-row">
                                        <!-- <div *ngIf="mech.userId && mech.isVerified == 1" class="checkbox">
                                            <label>
                                                <input type="checkbox" (change)="sendRequest(mech._id, $event.target.checked)"
                                                    [value]="mech._id">

                                                <ng-template #noMech>
                                                    <input type="checkbox" (change)="sendRequest(mech._id, $event.target.checked)"
                                                        [value]="mech._id">
                                                </ng-template>
                                                <span class="cr">
                                                    <i class="cr-icon fa fa-check"></i>
                                                </span>
                                            </label>
                                        </div> -->
                                        <div class="checkbox">
                                            <label>
                                                <input type="checkbox" (change)="sendRequest(mech._id, $event.target.checked)"
                                                    [value]="mech._id">

                                                <ng-template #noMech>
                                                    <input type="checkbox" (change)="sendRequest(mech._id, $event.target.checked)"
                                                        [value]="mech._id">
                                                </ng-template>
                                                <span class="cr">
                                                    <i class="cr-icon fa fa-check"></i>
                                                </span>
                                            </label>
                                        </div>

                                        <!-- <div *ngIf="!mech.userId || mech.isVerified == 0" class="checkbox">
                                            <label>
                                                <input type="checkbox">
                                                <ng-template #noMech>
                                                    <input type="checkbox" (change)="sendRequest('', $event.target.checked)"
                                                        [value]=''>
                                                </ng-template>
                                                <span class="cr">
                                                    <i class="cr-icon fa fa-check"></i>
                                                </span>
                                            </label>
                                        </div> -->
                                        <div class="list-box">
                                            <div class="list-header clearfix">
                                                <div class="header-left" *ngIf="mech.userId && mech.isVerified == 1">
                                                    <a [routerLink]="['/searchdetail',mech._id]">
                                                        <h4>{{mech.name}}
                                                            <span style="margin-left: 30px">/ {{mech.distance| number :
                                                                '1.2-2'}} miles
                                                            </span>
                                                        </h4>
                                                    </a>
                                                    <h5>{{mech.address.street}} {{mech.address.city}}
                                                        {{mech.address.state}}-
                                                        {{mech.address.postcode}}
                                                    </h5>
                                                    <ng-template #t let-fill="fill">
                                                        <span class="star" [class.full]="fill === 100">
                                                            <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                                                        </span>
                                                    </ng-template>
                                                    <!-- <ngb-rating [(rate)]="mech.rating" [starTemplate]="t" [readonly]="true"
                                                        max="5"></ngb-rating> -->
                                                    <ngb-rating *ngIf="mech.yelpRating" [(rate)]="mech.yelpRating"
                                                        [starTemplate]="t" [readonly]="true" max="5"></ngb-rating>

                                                    <ngb-rating *ngIf="!mech.yelpRating" [(rate)]="mech.rating"
                                                        [starTemplate]="t" [readonly]="true" max="5"></ngb-rating>
                                                    <!-- <div *ngIf="mech.rating==5" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                    </div>
                                                    <div *ngIf="mech.rating==4" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                    </div>
                                                    <div *ngIf="mech.rating==3" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                    </div>
                                                    <div *ngIf="mech.rating==2" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>

                                                    </div>
                                                    <div *ngIf="mech.rating==1" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                    </div>
                                                    <div *ngIf="mech.rating==0" class="star-rating">
                                                        No rating available
                                                    </div> -->

                                                    <h4 *ngIf="mech.isVerified=='1'">Verified</h4>
                                                    <h4 *ngIf="mech.isVerified=='0'">Not Verified</h4>
                                                </div>
                                                <!-- <h4 *ngIf="mech.isVerified=='1'">Verified</h4>
                                                    <h4 *ngIf="mech.isVerified=='0'">Not Verified</h4> -->



                                                <!--Details with no user id-->
                                                <div class="header-left" *ngIf="!mech.userId || mech.isVerified==0">
                                                    <a>
                                                        <h4>{{mech.name}}
                                                            <span style="margin-left: 30px">/ {{mech.distance| number :
                                                                '1.2-2'}} miles
                                                            </span>
                                                        </h4>
                                                    </a>
                                                    <h5>{{mech.address.street}} {{mech.address.city}}
                                                        {{mech.address.state}}-
                                                        {{mech.address.postcode}}
                                                    </h5>
                                                    <ng-template #t let-fill="fill">
                                                        <span class="star" [class.full]="fill === 100">
                                                            <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                                                        </span>
                                                    </ng-template>
                                                    <!-- <ngb-rating [(rate)]="mech.rating" [starTemplate]="t" [readonly]="true"
                                                        max="5"></ngb-rating> -->
                                                    <ngb-rating *ngIf="mech.yelpRating" [(rate)]="mech.yelpRating"
                                                        [starTemplate]="t" [readonly]="true" max="5"></ngb-rating>

                                                    <ngb-rating *ngIf="!mech.yelpRating" [(rate)]="mech.rating"
                                                        [starTemplate]="t" [readonly]="true" max="5"></ngb-rating>
                                                    <!-- <div *ngIf="mech.isVerified=='1'" class="star-rating">
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                        <i class="fa fa-star" aria-hidden="true"></i>
                                                    </div>

                                                    <div *ngIf="mech.rating==0">
                                                        No rating available
                                                    </div> -->
                                                    <h4 *ngIf="mech.isVerified=='1'">Verified</h4>
                                                    <h4 *ngIf="mech.isVerified=='0'">Not Verified</h4>
                                                </div>
                                                <!-- end of Details with no user id-->

                                                <!-- 
                               Load More     <div class="header-right">
                               Load More         <button [disabled]='isSchedule' (click)="sendSingleRequest(mech.userId)"
                               Load More             class="btn btn-info">Request a quote</button>
                                                </div> -->
                                                <!-- <div class="header-right" *ngIf="mech.userId && mech.isVerified == 1">
                                                    <button [disabled]='isSchedule' (click)="sendSingleRequest(mech.userId)"
                                                        class="btn btn-info">Request a quote</button>

                                                </div> -->
                                                <div class="header-right">
                                                    <button [disabled]='isSchedule' (click)="sendSingleRequest(mech._id)"
                                                        class="btn btn-info">Request a quote</button>

                                                </div>


                                                <!--Details with no user id-->

                                                <!-- <div class="header-right" *ngIf="!mech.userId || mech.isVerified == 0">

                                                    <button data-toggle="modal" [disabled]='isSchedule' (click)="setVaID(mech._id)"
                                                        class="btn btn-info">Request
                                                        a quote</button>
                                                </div> -->
                                                <!-- end of Details with no user id-->


                                            </div>
                                            <p>{{mech.description}}
                                            </p>
                                            <div class="list-nubmer">
                                                {{i+1}}
                                            </div>
                                        </div>
                                    </div>
                                    <!-- </div> -->

                                </div>


                            </div>
                        </div>
                        <button type="button" (click)="updateCount()" *ngIf="totalCount >mechanicList.length && mechanicList.length >0 "
                            class="btn btn-primary" style="margin-left:60px">
                            Load More
                        </button>



                        <a *ngIf="selectMechanic!=0">
                            <button [disabled]='!isSchedule' (click)="saveRequest()" type="submit" class="btn btn-primary pull-right">
                                Request a quote
                            </button>
                        </a>

                        <!-- <div class="box-footer clearfix">
                            <ngb-pagination class="pull-right" [collectionSize]="totalCount" [pageSize]="5"
                                (pageChange)="pageChange($event)" [(page)]="page" aria-label="Default pagination"></ngb-pagination>
                        </div> -->
                    </div>
                    <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
            </div>
            <!-- /.nav-tabs-custom -->
        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->
</section>

<div class="my-container">
    <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
</div>